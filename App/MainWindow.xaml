<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="App.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:App"
    xmlns:enums="using:App.Enums"
    xmlns:converters="using:App.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="moneo - tts">

	<Window.SystemBackdrop>
		<MicaBackdrop />
	</Window.SystemBackdrop>

	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="32"/>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
			<RowDefinition Height="Auto"/>
		</Grid.RowDefinitions>

		<!-- Custom Title Bar -->
		<Grid x:Name="AppTitleBar" Grid.Row="0" Background="Transparent">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="Auto"/>
				<ColumnDefinition Width="*"/>
			</Grid.ColumnDefinitions>

			<Image Source="/Assets/logo.svg" 
                   Width="24" Height="24" 
                   Margin="4"
                   VerticalAlignment="Center"/>

			<TextBlock Grid.Column="1"
                       Text="moneo | track and trace simulator"
                       Style="{StaticResource CaptionTextBlockStyle}"
                       VerticalAlignment="Center"/>
		</Grid>

		<!-- Header Card -->
		<Grid Grid.Row="1" Padding="4,0">
			<Border BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16">
				<Border.Background>
					<ImageBrush ImageSource="/Assets/background.svg"
								Stretch="UniformToFill"
								Opacity="0.2"
								AlignmentX="Center"
								AlignmentY="Center"/>
				</Border.Background>
				
				<StackPanel Orientation="Horizontal" VerticalAlignment="Center" Spacing="16">
					<Image Source="/Assets/logo.svg"
                           Width="64" Height="64"
                           VerticalAlignment="Center"/>

					<StackPanel Spacing="8">
						<TextBlock Text="moneo | track and trace simulator"
								   Style="{StaticResource TitleTextBlockStyle}"/>

						<StackPanel Orientation="Horizontal" Spacing="10">
							<!-- Version -->
							<StackPanel Orientation="Horizontal" Spacing="4">
								<FontIcon Glyph="&#xE946;" FontSize="12" Opacity="0.7"/>
								<TextBlock x:Name="VersionText"
										   Text="Version 1.0.0"
										   FontSize="12"
										   Opacity="0.7"/>
							</StackPanel>

							<!-- Status -->
							<StackPanel Orientation="Horizontal" Spacing="4">
								<FontIcon Glyph="&#xE968;" FontSize="12"/>
								<TextBlock Text="MQTT:"
										   FontSize="12"
										   Opacity="0.7"/>
								<!-- Status Indicator -->
								<Ellipse Width="8"
										 Height="8"
										 Margin="0,1,0,0"
										 Fill="{x:Bind StatusToBrush(MqttViewModel.Status), Mode=OneWay}">
								</Ellipse>
								<TextBlock Text="{x:Bind MqttViewModel.Status, Mode=OneWay}"
										   FontSize="12"
										   Opacity="0.7"/>
							</StackPanel>
						</StackPanel>
					</StackPanel>
				</StackPanel>
			</Border>
		</Grid>

		<!-- Main Content (Navigation) -->
		<Grid Grid.Row="2" Padding="0">
			<NavigationView x:Name="MainNavigationView"
							PaneDisplayMode="Top"
							IsBackButtonVisible="Collapsed"
							IsSettingsVisible="False"
							SelectionChanged="NavigationView_SelectionChanged">

				<NavigationView.Resources>
					<SolidColorBrush x:Key="NavigationViewContentBackground" Color="Transparent"/>
				</NavigationView.Resources>

				<NavigationView.MenuItems>
					<NavigationViewItem Content="Simulation" Tag="simulation" Icon="Play"/>
					<NavigationViewItem Content="Settings" Tag="settings" Icon="Setting"/>
				</NavigationView.MenuItems>

				<Frame x:Name="ContentFrame"/>
			</NavigationView>
		</Grid>

		<!-- Log Footer -->
		<Border Grid.Row="3" 
				Padding="4"
				Margin="4"
				Background="Black"
				Opacity="0.9"
				CornerRadius="8"
				BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
				BorderThickness="1">
			<StackPanel Spacing="8">
					<Button x:Name="ClearLogButton"
							Content="Clear Log"
							Click="ClearLog_Click"
							Grid.Column="1"
							Height="28"
							FontSize="10"/>

					<ListView x:Name="LogListView"
							  Height="80"
							  SelectionMode="None"
							  IsItemClickEnabled="False"
							  ScrollViewer.VerticalScrollBarVisibility="Auto"
							  ScrollViewer.HorizontalScrollBarVisibility="Disabled">
					<ListView.ItemContainerStyle>
						<Style TargetType="ListViewItem">
							<Setter Property="Padding" Value="8,4"/>
							<Setter Property="MinHeight" Value="0"/>
							<Setter Property="HorizontalContentAlignment" Value="Stretch"/>
							<Setter Property="Background" Value="Transparent"/>
						</Style>
					</ListView.ItemContainerStyle>
					<ListView.ItemTemplate>
						<DataTemplate x:DataType="x:String">
							<TextBlock Text="{x:Bind}"
									   TextWrapping="Wrap"
									   FontFamily="Consolas"
									   FontSize="11"
									   Foreground="LimeGreen"/>
						</DataTemplate>
					</ListView.ItemTemplate>
				</ListView>
			</StackPanel>
		</Border>
	</Grid>
</Window>
